# Architecture Détaillée

## Vue d'Ensemble du Système

```
┌─────────────────────────────────────────────────────────────┐
│                      UTILISATEUR                            │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                   APPLICATION WEB                           │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              React Todo List                         │   │
│  │  - TodoList Component                                │   │
│  │  - State Management (useState)                       │   │
│  │  - Event Handlers                                    │   │
│  └──────────────────────────────────────────────────────┘   │
│                         │                                    │
│                         ▼                                    │
│  ┌──────────────────────────────────────────────────────┐   │
│  │         OBSERVABILITY LAYER                          │   │
│  │  ┌────────────┐ ┌─────────────┐ ┌─────────────┐     │   │
│  │  │  Logger    │ │  Metrics    │ │  Tracing    │     │   │
│  │  │  (JSON)    │ │  (Gauges/   │ │  (OpenTel)  │     │   │
│  │  │            │ │  Counters)  │ │             │     │   │
│  │  └────────────┘ └─────────────┘ └─────────────┘     │   │
│  │         │              │                 │           │   │
│  └─────────┼──────────────┼─────────────────┼───────────┘   │
│            │              │                 │               │
│            ▼              ▼                 ▼               │
│  ┌──────────────────────────────────────────────────────┐   │
│  │            Console / Export                          │   │
│  │  - Development: Browser Console                     │   │
│  │  - Production: External Services (Grafana, Jaeger)  │   │
│  └──────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

## Architecture CI/CD

```
┌─────────────────────────────────────────────────────────────┐
│                     GITHUB REPOSITORY                        │
└────────────────────────┬────────────────────────────────────┘
                         │
                         │ Push / Pull Request
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                  GITHUB ACTIONS RUNNER                       │
│                                                              │
│  ┌────────────────────────────────────────────────────────┐ │
│  │  JOB 1: TEST                                           │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  │ │
│  │  │   Checkout   │→ │   Install    │→ │    Lint     │  │ │
│  │  └──────────────┘  └──────────────┘  └─────────────┘  │ │
│  │                                            │           │ │
│  │                                            ▼           │ │
│  │                                    ┌─────────────┐    │ │
│  │                                    │  Run Tests  │    │ │
│  │                                    └─────────────┘    │ │
│  └────────────────────────┬───────────────────────────────┘ │
│                           │ Success                         │
│                           ▼                                 │
│  ┌────────────────────────────────────────────────────────┐ │
│  │  JOB 2: BUILD                                          │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  │ │
│  │  │   Checkout   │→ │   Install    │→ │    Build    │  │ │
│  │  └──────────────┘  └──────────────┘  └─────────────┘  │ │
│  │                                            │           │ │
│  │                                            ▼           │ │
│  │                                    ┌─────────────┐    │ │
│  │                                    │   Upload    │    │ │
│  │                                    │  Artifacts  │    │ │
│  │                                    └─────────────┘    │ │
│  └────────────────────────┬───────────────────────────────┘ │
│                           │ Success (main branch only)     │
│                           ▼                                 │
│  ┌────────────────────────────────────────────────────────┐ │
│  │  JOB 3: DEPLOY                                         │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  │ │
│  │  │ Setup Pages  │→ │Upload Artifact│→ │   Deploy    │  │ │
│  │  └──────────────┘  └──────────────┘  └─────────────┘  │ │
│  └────────────────────────┬───────────────────────────────┘ │
└────────────────────────────┼────────────────────────────────┘
                             │
                             ▼
                  ┌─────────────────────┐
                  │   GITHUB PAGES      │
                  │  (Live Website)     │
                  └─────────────────────┘
```

## Flux de Données - Observabilité

```
┌──────────────────────────────────────────────────────────┐
│              USER ACTION (Add Todo)                      │
└────────────────────────┬─────────────────────────────────┘
                         │
                         ▼
┌──────────────────────────────────────────────────────────┐
│  TodoList Component: addTodo()                           │
└────────────────────────┬─────────────────────────────────┘
                         │
          ┌──────────────┼──────────────┐
          │              │              │
          ▼              ▼              ▼
     ┌────────┐    ┌─────────┐    ┌────────┐
     │ Logger │    │ Metrics │    │ Tracer │
     └────┬───┘    └────┬────┘    └───┬────┘
          │             │              │
          ▼             ▼              ▼
┌──────────────────────────────────────────────────────────┐
│                    CONSOLE OUTPUT                        │
│                                                          │
│  {                                                       │
│    "timestamp": "2025-10-19T...",                       │
│    "level": "INFO",                                     │
│    "context": "TodoList",                               │
│    "message": "Todo added",                             │
│    "todoId": 123456789                                  │
│  }                                                       │
│                                                          │
│  [METRIC] Counter todos_added = 1                       │
│                                                          │
│  {                                                       │
│    "traceId": "a1b2c3...",                             │
│    "spanId": "x1y2z3...",                              │
│    "name": "add_todo",                                  │
│    "duration": 1234                                     │
│  }                                                       │
└──────────────────────────────────────────────────────────┘
```

## Architecture des Composants

```
src/
│
├── components/
│   └── TodoList.jsx ────────┐
│                            │
├── observability/           │
│   ├── logger.js ───────────┼───► Logger Instance
│   ├── metrics.js ──────────┼───► Metrics Collector
│   ├── tracing.js ──────────┼───► Tracer
│   └── performance.js ──────┼───► Web Vitals
│                            │
└── App.jsx ─────────────────┘
    │
    └── Initialize All Observability
```

## Flux de Test

```
┌─────────────────────────────────────────────────────────┐
│  Vitest Test Runner                                     │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│  Happy-DOM Environment Setup                            │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│  Test Suites                                            │
│  ┌────────────────────────────────────────────────┐    │
│  │  TodoList.test.jsx (9 tests)                   │    │
│  │  - Component rendering                         │    │
│  │  - User interactions                           │    │
│  │  - State management                            │    │
│  │  - Statistics                                  │    │
│  └────────────────────────────────────────────────┘    │
│  ┌────────────────────────────────────────────────┐    │
│  │  logger.test.js (6 tests)                      │    │
│  │  - Log formatting                              │    │
│  │  - Log levels                                  │    │
│  │  - Metadata handling                           │    │
│  └────────────────────────────────────────────────┘    │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
              ┌──────────────┐
              │ Test Results │
              │  15/15 ✓     │
              └──────────────┘
```

## Déploiement Production

```
┌─────────────────────────────────────────────────────────┐
│  Local Development                                      │
│  $ git commit -m "feat: new feature"                    │
│  $ git push origin main                                 │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│  GitHub Actions Trigger                                 │
│  - Run tests                                            │
│  - Build application                                    │
│  - Generate artifacts                                   │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│  GitHub Pages CDN                                       │
│  - Serve static files                                   │
│  - HTTPS enabled                                        │
│  - Global distribution                                  │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
              ┌──────────────┐
              │  End Users   │
              └──────────────┘
```

## Performance Budget

```
Asset Type    │ Development │ Production │ Gzipped  │ Target
──────────────┼─────────────┼────────────┼──────────┼────────
HTML          │   ~1 KB     │   0.49 KB  │  0.30 KB │  < 1 KB
CSS           │   ~3 KB     │   2.24 KB  │  0.94 KB │  < 3 KB
JavaScript    │  ~500 KB    │ 284.11 KB  │ 90.23 KB │ < 100 KB
──────────────┼─────────────┼────────────┼──────────┼────────
Total         │  ~504 KB    │ 286.84 KB  │ 91.47 KB │ < 105 KB
```

## Extensibilité Future

### Observabilité Backend

```
Application ──────────► OpenTelemetry Collector
     │                           │
     │                           ├──► Prometheus (Métriques)
     │                           │
     │                           ├──► Jaeger (Traces)
     │                           │
     │                           └──► Loki (Logs)
     │
     └──────────────────────────► Grafana Dashboards
```

### Environnements Multiples

```
Code Repository
     │
     ├──► develop branch ──► Development Environment
     │
     ├──► staging branch ──► Staging Environment
     │
     └──► main branch ────► Production Environment
```

